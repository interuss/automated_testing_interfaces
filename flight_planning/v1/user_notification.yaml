info:
  title: Definitions used in flight planning interface for user notification.
components:
  schemas:
    ConflictNotification:
      type: object
      description: Notification of conflict with new/modified operations or intersection with constraints.
      required:
        - intersection_detected_at
        - notification_sent_at
        - impacted_flight_id
      properties:
        intersection_detected_at:
          anyOf:
            - $ref: './geotemporal.yaml#/components/schemas/Time'
          description: >-
            Time at which the intersection with other operational_intents was detected by USS.
            For the purpose of tests, the value of intersection_detected_at is described below for two scenarios.
             - USS managing flights for a user, maintains awareness of any new or modified operational intents.
            Upon successfully receiving any notification of a new or modified operation the USS responds with status 204 to the notifying USS, 
            and also checks for any intersections detected. The time the USS responds with 204 will be taken as the value of intersection_detected_at.
             - USS checks for intersections with existing operational intents or constraints while creating or modifying a flight for an UpsertFlightPlan request.
            When successful, the USS responds back with 200 status and a planning result as Completed. 
            The time USS responds with 200 will be taken as the value of intersection_detected_at.
        notification_sent_at:
          anyOf:
            - $ref: './geotemporal.yaml#/components/schemas/Time'
          description: Time at which the user or user's automated system was sent user notification about the conflict or intersection.
        impacted_flight_id:
          description: Flight_id of the user flight that is impacted by the conflict.
          type: array
          items:
            type: string
            format: uuid
            maxLength: 36
            minLength: 36
            pattern: >-
              ^[0-9a-fA-F]{8}\\-[0-9a-fA-F]{4}\\-4[0-9a-fA-F]{3}\\-[8-b][0-9a-fA-F]{3}\\-[0-9a-fA-F]{12}$
        conflicts_count:
          description: >-  
            Number of conflicting operational intents reported by the notification.
            If the user notification is triggered as a result of creating or modifying a flight, the conflicts_count
            can have value greater than 1, depending on number of conflicting operations detected.
            If the user notification is triggered by receipt of notification of a new or modified
            operational intent from another USS, the conflicts_count value is 1.                        
            If not provided, the default value is 0, which would mean there are only constraints intersecting
          type: integer
          minimum: 0
        conflict_entity_ids:
          description: >-
            These are the ids of the conflicting entities. This field is kept optional as some USSes might not share
            conflict entity ids like operation entity id or constraint id.
          maxLength: 36
          minLength: 36
          type: string
          format: uuid
          pattern: >-
            ^[0-9a-fA-F]{8}\\-[0-9a-fA-F]{4}\\-4[0-9a-fA-F]{3}\\-[8-b][0-9a-fA-F]{3}\\-[0-9a-fA-F]{12}$
          example: 03e5572a-f733-49af-bc14-8a18bd53ee39
        constraints:
          description: >-
            List of constraints that intersect with a flight. 
            It would contain one constraint when triggered by notification of a constraint from another USS.
            It could contain multiple constraints when triggered by creation or modification of a flight.
          type: array
          items: object